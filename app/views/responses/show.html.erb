<div class="row border rounded">
  <div class="col-9">
    <h1 class="mt-3 text-center">
      <%= @questionnaire.title %>
    </h1>
  </div>
  <div class="col-12 p-3">
    <%= @questionnaire.description %>
  </div>

  <div class="col-sm-9 offset-sm-2 border-bottom mb-3">
  <% %w(name address email phone age sex).each do |detail| %>
    <% val = @response.send(detail) %>
    <% if val %>
      <p><strong><%= detail.capitalize %>:</strong> <%= present(detail) %></p>
    <% end %>
  <% end %>
  </div>
    
  <% @response.answers.each_with_index do |answer, i| %>
    <div class="col-sm-9 offset-sm-2">
      <h5>Question <%= i + 1 %>.</h5>
      <p class="text-light bg-dark px-2"><%= answer.question.blurb %></p>
      <% case answer.question.answer_type.to_sym %>
      <% when :single_line, :multi_line %>
        <p><%= answer.atext %></p>
      <% when :yes_no %>
        <p><%= answer.yes_no ? 'Yes' : 'No' %></p>
      <% when :true_false %>
        <p><%= answer.yes_no.to_s.humanize %></p>
      <% when :multiple_choice_single %>
        <p><%= answer.question.choices[answer.choice.to_i] %></p>
      <% when :multiple_choice_any %>
        <% if answer.choice.present? %>
          <p><%= answer.question.choices.values_at(*(JSON.parse(answer.choice).map {|n| n.to_i})).join(' &bull; ').html_safe %></p>
        <% else %>
          <p class="text-muted">(No choices selected)</p>
        <% end %>
      <% end %>
    </div>
  <% end %>
  
</div>
<div class="row pt-3 d-print-none">
  <div class="col-12">
    <%= link_to 'Back', questionnaire_responses_path(@questionnaire), class: 'btn btn-secondary', role: 'button' %>
  </div>
</div>